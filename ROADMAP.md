# snapshot-runner Roadmap

## ✅ 実装済み機能 (v1.0.0)

### 1. 特定テストの検出機能
- ✅ カーソル位置のテストを検出して更新 (`:SnapshotTest`)
- ✅ 全テストのスナップショット更新 (`:Snapshot`, `:SnapshotAll`)
- ✅ テストファイル自動認識 (.test.js, .spec.ts等)

### 2. パッケージマネージャー対応
- ✅ npm/yarn/pnpm自動検出
- ✅ ロックファイルに基づく適切なコマンド実行

### 3. エラーハンドリング
- ✅ テストファイル以外での警告表示
- ✅ テストが見つからない場合の警告
- ✅ コマンド実行失敗時の詳細エラー表示
- ✅ 型安全なエラークラス (SnapshotRunnerError)
- ✅ ユーザーフレンドリーなエラーメッセージ

### 4. パフォーマンス最適化
- ✅ ファイル読み込みキャッシュシステム
- ✅ 大容量ファイル対応（1000行以上）
- ✅ パッケージマネージャー検出の高速化
- ✅ テスト解析処理の最適化

### 5. 非同期実行とプロセス管理
- ✅ 設定可能な非同期/同期実行モード
- ✅ バックグラウンドタスクの非ブロッキング実行
- ✅ 非同期実行時の適切な進捗通知

### 6. 型安全な設定システム
- ✅ TypeScript型ガードによる設定値検証
- ✅ Vim変数からの安全な設定読み込み
- ✅ デフォルト設定の自動適用

### 7. プログレス表示とキャンセル機能
- ✅ 実行中のプログレス表示 (spinner, percentage)
- ✅ 実行時間の計測と表示
- ✅ キャンセル機能 (AbortSignal対応)
- ✅ 実行ログの詳細表示

### 8. スナップショットdiff表示
- ✅ `:SnapshotDiff` で差分表示
- ✅ 更新前後の比較ビュー
- ✅ 部分的な更新の承認/拒否

## 🚀 今後の実装予定

### 1. テスト実行結果の詳細表示 (優先度: 高)
- **目的**: 更新内容の可視化とトラブルシューティング
- **実装案**:
  - 更新されたスナップショット数とファイル一覧
  - 削除された古いスナップショットの通知
  - QuickFixリストへの結果出力
  - テスト実行時間とパフォーマンス統計

### 2. 保存前バックアップとロールバック機能 (優先度: 高)
- **目的**: スナップショット更新の安全性向上
- **実装案**:
  - スナップショット更新前の自動バックアップ
  - `:SnapshotRevert` で前回状態への復元
  - バックアップファイルの管理と自動クリーンアップ
  - git統合による変更差分表示

### 3. 設定項目の拡張 (優先度: 中)
- **目的**: より細かい動作制御
- **実装案**:
  - カスタムテストパターンの設定
  - 除外ディレクトリ/ファイルの指定
  - デバッグログレベルの設定
  - 自動保存のタイミング制御

### 4. Visual mode対応 (優先度: 中)
- **目的**: 複数テストの一括更新
- **実装案**:
  - Visual modeで選択した範囲内のテストを検出
  - `:'<,'>SnapshotTests` コマンド
  - describe ブロック全体の選択対応

### 5. Telescope統合 (優先度: 中)
- **目的**: テストの検索と選択的実行
- **実装案**:
  - `:Telescope snapshot_runner tests` でテスト一覧表示
  - ファジー検索でテストを絞り込み
  - 複数選択して一括実行
  - プレビューでテストコード表示

### 6. Neovim統合の強化 (優先度: 中)
- **目的**: Neovimエコシステムとの連携強化
- **実装案**:
  - LSP diagnosticsとの連携（テスト失敗箇所のハイライト）
  - nvim-notify との統合による美しい通知
  - statusline/winbar への実行状況表示
  - trouble.nvim との連携によるエラー一覧表示

### 7. テストウォッチモード (優先度: 低)
- **目的**: ファイル保存時の自動実行
- **実装案**:
  - `:SnapshotWatch` でウォッチモード開始
  - ファイル変更検知で関連テストのみ実行
  - 結果のインライン表示

### 8. CI/CD統合とリモート実行 (優先度: 低)
- **目的**: 開発ワークフローとの統合
- **実装案**:
  - GitHub Actions との連携
  - Docker コンテナ内でのテスト実行
  - リモートサーバーでのテスト実行
  - 実行結果のSlack/Discord通知

## 開発方針
- 全機能をTDD（テスト駆動開発）で実装
- Denops APIを最大限活用した高性能実装
- ユーザビリティを重視したエラーメッセージ
- 他のNeovimプラグインとの連携を考慮